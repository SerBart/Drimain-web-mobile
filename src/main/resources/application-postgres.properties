# PostgreSQL profile configuration
# This profile enables local PostgreSQL development with Flyway migrations

# === PostgreSQL Datasource Configuration ===
spring.datasource.url=jdbc:postgresql://localhost:5432/drimain
spring.datasource.username=drimain
spring.datasource.password=drimain
spring.datasource.driver-class-name=org.postgresql.Driver

# === Flyway Configuration ===
# Enable Flyway for database migrations
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
# Allow Flyway to baseline existing schema (one-time setup)
spring.flyway.baseline-on-migrate=true

# === JPA Configuration ===
# Use validate mode since Flyway handles schema changes
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect

# === Disable Spring SQL Init ===
# Prevent conflicts with Flyway by disabling Spring's init scripts
spring.sql.init.mode=never

# === JWT Configuration ===
# Enable developer-friendly fallback for missing JWT secrets in this profile
jwt.allow-missing-in-dev=true

# To set JWT secret via environment variable in PowerShell:
# $env:JWT_SECRET_PLAIN="your_secure_secret_key_32_plus_characters"
# or
# $env:JWT_SECRET_BASE64="your_base64_encoded_secret"
# 
# Then run: mvn spring-boot:run -D"spring-boot.run.profiles=postgres"

# === Other Settings ===
jwt.expiration.minutes=60
server.port=8080

# === Logging Configuration ===
logging.level.org.flywaydb=INFO
logging.level.org.hibernate.SQL=INFO
logging.level.root=INFO